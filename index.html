<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ù†Ø¸Ø§Ù… ØªØ­Ù„ÙŠÙ„ Ù…Ø¨Ø§Ø¯Ø±Ø© Ø§Ø±ØªÙ‚Ø§Ø¡</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />

    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700;800&family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --primary-color: #1e293b;
        --accent-color: #2563eb;
        --success-color: #059669;
        --danger-color: #dc2626;
        --bg-color: #f8fafc;
        --border-color: #cbd5e1;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Cairo", sans-serif;
        background-color: var(--bg-color);
        margin: 0;
        padding: 20px;
        color: #334155;
        direction: rtl;
      }

      /* --- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… --- */
      .control-panel {
        background: #ffffff;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        margin-bottom: 40px;
        border: 1px solid var(--border-color);
        max-width: 1100px;
        margin-left: auto;
        margin-right: auto;
      }

      .panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid #f1f5f9;
        padding-bottom: 15px;
        margin-bottom: 20px;
      }

      .control-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .control-group h3 {
        font-size: 14px;
        color: var(--accent-color);
        margin-bottom: 10px;
        font-weight: 700;
      }

      .input-field {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        font-family: "Cairo";
        font-size: 13px;
        margin-bottom: 8px;
      }

      .actions-bar {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #f1f5f9;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-family: "Cairo";
        font-weight: 700;
        font-size: 14px;
      }
      .btn-primary {
        background: var(--accent-color);
        color: white;
      }
      .btn-success {
        background: var(--success-color);
        color: white;
      }
      .btn-danger {
        background: #fee2e2;
        color: var(--danger-color);
      }
      .btn-outline {
        background: white;
        border: 1px solid var(--border-color);
        color: #64748b;
      }

      .file-upload-wrapper {
        border: 2px dashed var(--accent-color);
        padding: 20px;
        text-align: center;
        border-radius: 12px;
        background: #eff6ff;
        cursor: pointer;
        margin-top: 10px;
      }

      /* --- ØµÙØ­Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± (A4) --- */
      .page-container {
        width: 210mm;
        min-height: 297mm;
        margin: 0 auto;
        background: #fff;
        padding: 15mm;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        position: relative;
      }

      /* Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© (Ø§Ù„ÙƒÙ„ÙŠØ´Ø©) */
      .header-section {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        border-bottom: 3px solid var(--primary-color);
        padding-bottom: 10px;
        margin-bottom: 20px;
      }
      .header-col {
        flex: 1;
        text-align: center;
      }

      .header-right .header-text,
      .header-left .header-text {
        font-size: 13px;
        font-weight: 600;
        margin-bottom: 4px;
        white-space: nowrap;
      }

      .report-title {
        font-weight: 800;
        font-size: 18px;
        color: var(--primary-color);
        margin-bottom: 5px;
        white-space: nowrap;
      }

      .header-left .header-text {
        text-align: left;
        padding-left: 10px;
      }

      /* Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
      .info-bar {
        background-color: #f8fafc;
        border: 1px solid #e2e8f0;
        padding: 10px;
        border-radius: 6px;
        margin-bottom: 25px;
        display: flex;
        justify-content: space-around;
        font-weight: 700;
        font-size: 14px;
      }

      /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
      .table-section {
        margin-bottom: 30px;
        width: 100%;
        break-inside: avoid;
        page-break-inside: avoid;
      }

      .section-title {
        font-family: "Cairo", sans-serif;
        font-weight: 800;
        font-size: 16px;
        color: var(--primary-color);
        margin-bottom: 8px;
        border-right: 6px solid var(--accent-color);
        padding-right: 12px;
        background-color: #f1f5f9;
        padding: 5px;
        border-radius: 4px;
        text-align: right;
        page-break-after: avoid;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 13px;
        margin-bottom: 5px;
      }
      th,
      td {
        border: 1px solid #94a3b8;
        padding: 6px 4px;
        text-align: center;
      }

      .header-counts th {
        background-color: #1e293b;
        color: #fff;
      }
      .header-percents th {
        background-color: #0f766e;
        color: #fff;
      }
      .header-stats-1 th {
        background-color: #4338ca;
        color: #fff;
      }
      .header-stats-2 th {
        background-color: #c2410c;
        color: #fff;
      }

      tr:nth-child(even) {
        background-color: #f8fafc;
      }
      .percent-cell {
        font-weight: 700;
        color: var(--accent-color);
        direction: ltr;
      }

      /* Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ */
      .chart-section {
        margin-top: auto;
        break-inside: avoid;
        page-break-inside: avoid;
        padding-bottom: 20px;
      }
      .chart-container {
        width: 100%;
        height: 400px !important;
        padding: 10px;
        background: #fff;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
      }

      /* Ø§Ù„ØªØ°ÙŠÙŠÙ„ */
      .footer-section {
        margin-top: 50px;
        display: flex;
        justify-content: space-between;
        padding: 0 40px;
        break-inside: avoid;
      }
      .signature-box {
        text-align: center;
        width: 220px;
      }
      .signature-title {
        font-weight: bold;
        margin-bottom: 40px;
        font-size: 15px;
      }
      .signature-line {
        border-top: 1px solid #333;
        padding-top: 5px;
        font-weight: bold;
        font-size: 15px;
      }

      /* Ø·Ø¨Ø§Ø¹Ø© */
      @media print {
        .control-panel {
          display: none;
        }
        body {
          background: white;
          padding: 0;
        }
        .page-container {
          margin: 0;
          box-shadow: none;
          width: 100%;
          padding: 10mm;
        }
        .chart-container {
          height: 350px !important;
          border: 1px solid #ccc;
        }
        .section-title {
          background-color: #eee !important;
          -webkit-print-color-adjust: exact;
        }
        th {
          -webkit-print-color-adjust: exact;
        }
        .header-text {
          font-size: 12px !important;
        }
        .footer-section {
          margin-top: 40px !important;
        }
      }
      /* --- ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ø³ÙÙ„ÙŠ (Ø­Ù‚ÙˆÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±) --- */
      .app-footer {
        text-align: center; /* ØªÙˆØ³ÙŠØ· */
        font-size: 12px; /* ØªØµØºÙŠØ± Ø§Ù„Ø®Ø· */
        margin-top: 50px; /* Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ */
        margin-bottom: 20px; /* Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„ */
        color: #64748b; /* Ù„ÙˆÙ† Ø±Ù…Ø§Ø¯ÙŠ Ø£Ù†ÙŠÙ‚ */
        font-weight: 600;
      }
      .app-footer a {
        color: var(--accent-color);
        text-decoration: none;
      }
      .app-footer a:hover {
        text-decoration: underline;
      }

      /* --- ÙƒÙ„Ø§Ø³ Ù„Ù…Ù†Ø¹ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© --- */
      /* ØªØ£ÙƒØ¯ Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø®Ù„ Ø£Ùˆ Ù…Ø¹ Ø£ÙƒÙˆØ§Ø¯ @media print */
      @media print {
        .no-print {
          display: none !important;
        }
      }
      /* --- 1. ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙ‚Ù„ (Ø¬Ø¯ÙŠØ¯) --- */
      .ministry-logo {
        max-width: 120px; /* Ø¹Ø±Ø¶ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø´Ø¹Ø§Ø± */
        max-height: 100px;
        margin: 0 auto 10px auto; /* ØªÙˆØ³ÙŠØ· + Ù…Ø³Ø§ÙØ© Ø³ÙÙ„ÙŠØ© */
        display: block;
      }

      /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙ‚Ù„Ø© - Ø¨Ø­Ø¯ÙˆØ¯ Ø¢Ù…Ù†Ø© */
      .report-title-wrapper {
        text-align: center;
        margin: 20px auto 30px auto; /* Ù…Ø³Ø§ÙØ§Øª Ø±Ø£Ø³ÙŠØ© Ù…Ø±ÙŠØ­Ø© */
        padding: 10px;
        width: 85%; /* Ø¹Ø±Ø¶ Ø¢Ù…Ù† ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ„Ø§Ù…Ø³ Ù…Ø¹ Ø§Ù„Ø­ÙˆØ§Ù */
        border-bottom: 2px solid #e2e8f0; /* Ø®Ø· ÙØ§ØµÙ„ Ø£Ù†ÙŠÙ‚ */
        page-break-after: avoid; /* ÙŠÙ…Ù†Ø¹ ÙØµÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¹Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
      }

      .report-main-title {
        font-family: "Cairo", sans-serif;
        font-weight: 800;
        font-size: 20px;
        color: var(--primary-color);
        margin: 0;
      }

      /* --- 2. Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Ù‚Øµ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ ÙÙŠ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© --- */
      @media print {
        .chart-section {
          page-break-inside: avoid !important; /* ÙŠÙ…Ù†Ø¹ Ø§Ù†Ù‚Ø³Ø§Ù… Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
          break-inside: avoid !important;
          margin-top: 20px;
        }
        .chart-container {
          height: 350px !important; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© */
          page-break-inside: avoid !important;
        }
        /* Ø¶Ø¨Ø· Ù‡ÙˆØ§Ù…Ø´ Ø§Ù„ØµÙØ­Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ù„ØªÙˆÙÙŠØ± Ù…Ø³Ø§Ø­Ø© */
        .page-container {
          padding: 10mm !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="control-panel">
      <div class="panel-header">
        <div>
          <h2 style="margin: 0; color: var(--primary-color)">
            ğŸ“Š Ù†Ø¸Ø§Ù… ØªØ­Ù„ÙŠÙ„ Ù…Ø¨Ø§Ø¯Ø±Ø© Ø§Ø±ØªÙ‚Ø§Ø¡ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠ
          </h2>
        </div>
        <div style="display: flex; gap: 10px">
          <button class="btn btn-outline" onclick="saveSettings()">
            ğŸ’¾ Ø­ÙØ¸
          </button>
          <button class="btn btn-danger" onclick="clearSettings()">
            ğŸ§¹ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
          </button>
        </div>
      </div>

      <div class="control-grid">
        <div class="control-group">
          <h3>ğŸ”¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© (Ø§Ù„ÙƒÙ„ÙŠØ´Ø©)</h3>
          <input
            type="text"
            id="inp_right1"
            class="input-field"
            value="Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"
            oninput="updateUI()"
          />
          <input
            type="text"
            id="inp_right2"
            class="input-field"
            value="ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…"
            oninput="updateUI()"
          />
          <input
            type="text"
            id="inp_right3"
            class="input-field"
            value="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø¨Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±ÙŠØ§Ø¶"
            oninput="updateUI()"
          />
        </div>

        <div class="control-group">
          <h3>ğŸ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h3>
          <input
            type="text"
            id="inp_school"
            class="input-field"
            placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©..."
            oninput="updateUI()"
          />
          <input
            type="text"
            id="inp_report_title"
            class="input-field"
            value="ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ´Ø®ÙŠØµÙŠ Ø§Ù„Ø£ÙˆÙ„ Ù€ Ù…Ø¨Ø§Ø¯Ø±Ø© Ø§Ø±ØªÙ‚Ø§Ø¡"
            placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ±"
            oninput="updateUI()"
          />
          <input
            type="text"
            id="inp_year"
            class="input-field"
            value="1447 Ù‡Ù€"
            placeholder="Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ"
            oninput="updateUI()"
          />
          <input
            type="text"
            id="inp_term"
            class="input-field"
            value="Ø§Ù„Ø«Ø§Ù†ÙŠ"
            placeholder="Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ"
            oninput="updateUI()"
          />
        </div>

        <div class="control-group">
          <h3>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„ØµÙ</h3>
          <input
            type="text"
            id="inp_grade"
            class="input-field"
            placeholder="Ø§Ù„ØµÙ (Ù…Ø«Ø§Ù„: Ø§Ù„Ø³Ø§Ø¯Ø³)"
            oninput="updateUI()"
          />
          <input
            type="text"
            id="inp_section"
            class="input-field"
            placeholder="Ø§Ù„ÙØµÙ„"
            oninput="updateUI()"
          />
          <input
            type="number"
            id="inp_max_score"
            class="input-field"
            placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¹Ø¸Ù…Ù‰ (Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©)"
            value="15"
          />
        </div>

        <div class="control-group">
          <h3>âœï¸ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ ÙˆØ§Ù„ØªØ°ÙŠÙŠÙ„</h3>
          <input
            type="text"
            id="inp_principal"
            class="input-field"
            placeholder="Ø§Ø³Ù… Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©"
            oninput="updateUI()"
          />
          <input
            type="text"
            id="inp_date"
            class="input-field"
            placeholder="ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
            oninput="updateUI()"
          />
        </div>
      </div>

      <div
        class="file-upload-wrapper"
        onclick="document.getElementById('fileInput').click()"
      >
        <h3 style="margin-top: 0; color: var(--accent-color)">
          ğŸ“‚ Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ø§Ù„Ø¥ÙƒØ³Ù„
        </h3>
        <p style="margin-bottom: 0; color: #64748b; font-size: 13px">
          ÙŠØ¯Ø¹Ù… Ù…Ù„ÙØ§Øª Ø§Ø±ØªÙ‚Ø§Ø¡ + Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
        </p>
        <input
          type="file"
          id="fileInput"
          multiple
          accept=".xlsx, .xls, .csv"
          style="display: none"
          onchange="handleFiles(this.files)"
        />
      </div>

      <div class="actions-bar">
        <button class="btn btn-outline" onclick="newAnalysis()">
          âœ¨ ØªØ­Ù„ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
        </button>
        <button class="btn btn-success" onclick="exportToExcel()">
          ğŸ“ˆ ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (Excel)
        </button>
        <button class="btn btn-primary" onclick="window.print()">
          ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        </button>
      </div>
    </div>

    <div class="page-container" id="reportContainer">
      <div class="header-section">
        <div class="header-col header-right">
          <div class="header-text" id="out_right1"></div>
          <div class="header-text" id="out_right2"></div>
          <div class="header-text" id="out_right3"></div>
        </div>

        <div class="header-col header-center">
          <img
            src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgNDMzIDMyMyI+CiAgPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI5LjguMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDIuMS4xIEJ1aWxkIDIpICAtLT4KICA8ZGVmcz4KICAgIDxzdHlsZT4KICAgICAgLnN0MCB7CiAgICAgICAgZmlsbDogbm9uZTsKICAgICAgfQoKICAgICAgLnN0MSB7CiAgICAgICAgZmlsbDogdXJsKCNsaW5lYXItZ3JhZGllbnQpOwogICAgICB9CgogICAgICAuc3QyIHsKICAgICAgICBjbGlwLXBhdGg6IHVybCgjY2xpcHBhdGgpOwogICAgICB9CiAgICA8L3N0eWxlPgogICAgPGNsaXBQYXRoIGlkPSJjbGlwcGF0aCI+CiAgICAgIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik02Mi4yNSwzMDIuNjRoMy42N3YtMTkuNTloLTMuNjd2MTkuNTlaTTk4Ljg4LDMwMi42OGgzLjY3di0xOS44NWgtMy42N3MwLDE5Ljg1LDAsMTkuODVaTTE2OS4xOCwyODIuODNsLS4wNCwxMS4xMWMwLDEuMjItLjExLDIuMzItLjMzLDMuMjctLjI1Ljg5LS41OCwxLjU4LTEuMDIsMi4xMS0uNDEuNS0uOTcuODgtMS42NiwxLjEtLjQxLjE1LS45Ny4yMy0xLjY3LjI3LS43My0uMDQtMS4yOS0uMTItMS43MS0uMjctLjY4LS4yMy0xLjI0LS42LTEuNjUtMS4xLS40My0uNTItLjc2LTEuMjItMS4wMi0yLjExLS4yMy0uOTYtLjMzLTIuMDItLjMzLTMuMjdsLS4wNS0xMS4xMWgtMy40M2wtLjA0LDExLjI4LjA1LjYxYy4xOSwyLjIyLjMzLDMuOTgsMS40OCw1LjMyLjc4Ljg4LDEuNzcsMS41NSwyLjk0LDEuOTkuOTYuMzYsMi4wOS41OSwzLjQ3LjYzaC4xMnYuMDNoMGMuMDksMCwuMjEsMCwuMywwaDB2LS4wM2guMTNjMS4zOC0uMDQsMi41LS4yNywzLjQ4LS42My4xNy0uMDcuMzItLjE1LjQ3LS4yNC4wOS0uMDUuMTktLjExLjI4LS4xNWwuMTktLjExdjMuNzNjMCwxLjIzLS4xMiwyLjMzLS4zNCwzLjI3LS4yNS45LS41OCwxLjU5LTEuMDIsMi4xLS40MS41Mi0uOTcuOS0xLjY2LDEuMTMtLjU2LjE3LTEuMjQuMjctMi4wMy4yOGwuMTksMS45OWMxLjQ2LS4wMywyLjc5LS4yNSwzLjkzLS42OCwxLjE3LS40NCwyLjE0LTEuMTIsMi45MS0yLDEuMTctMS4zMywxLjI5LTMuMSwxLjQ5LTUuMzJsLjA1LS42Mi0uMDMtMTEuMDguMDMtLjI1LS4wNC0xMS4yNmgtMy40M2wtLjAzLjAyWk0yOTEuMTgsMjgyLjgzdjE3Ljg3aC02Ljg2Yy0yLjY1LDAtNC43OS0yLjE0LTQuNzktNC43OHYtMTMuMDloLTMuNTlsLS4wNCwxMC4zN2MwLDMuNjksMS4xOCw1LjU3LDIuMjIsNi43OC43OC44OCwxLjc2LDEuNTUsMi45NCwyLC45OC4zNywyLjE0LjU5LDMuNDMuNjVoMTAuMzVzMC0xOS44LDAtMTkuOGgtMy42NlpNMzA4LjE3LDI4Mi44NWMtMS4yOC4wNS0yLjQyLjI1LTMuMzkuNjQtMS4xNi40NC0yLjEzLDEuMS0yLjksMS45OC0xLjA4LDEuMjgtMi4xOSwyLjkxLTIuMTksNS40NHYyLjQ0YzAsMi44My42Niw0LjkxLDIuMTksNi42OS43Ny44NiwxLjc0LDEuNTQsMi45LDEuOTcuOTcuMzcsMi4xMi41OSwzLjM5LjYzaC4xNHYuMDNoOC42MXYtMS45aC04LjM0Yy0yLjYxLDAtNC43NS0yLjExLTQuNzUtNC43MywwLDAtLjE0LTIuMjItLjE0LTMuNDNzLjE0LTMuMTIuMTQtMy4xMmMwLTIuNjIsMi4xMy00Ljc1LDQuNzUtNC43NWg4LjM0di0xLjlsLTguNzUuMDN2LS4wMlpNMzYwLjA4LDMwMi42OGgzLjY3di0xOS44NWgtMy42N3YxOS44NVpNMzcyLjk5LDI5NS4wN2MtLjI1LTIuNDQtLjQxLTYuODMsMS40OS04Ljg3Ljg5LS45NCwyLjE0LTEuNDksMy40My0xLjQ5aDEuNDljMy44MiwwLDQuNjksMy44Myw0LjkxLDUuNDkuMTYsMS4yOS4zNiwzLjc2LS4wNyw1Ljk2LS4yMSwxLjEtLjU2LDIuMDEtMS4wNCwyLjY3LS44OCwxLjIyLTIuMywxLjk0LTMuNzksMS45NGgtMS41Yy0zLjg4LDAtNC43My0zLjk4LTQuOTItNS43TTM3Ny42MiwyODIuODNsLS4xMS4wM2MtMS4yNi4wNC0yLjQxLjI3LTMuMzYuNjMtMS4xNC40My0yLjExLDEuMDgtMi44NywxLjk1LTEsMS4xOC0yLjE3LDMtMi4xNyw2LjZ2MS40MmMwLDIuOC42OCw0Ljg1LDIuMTcsNi42Ljc2Ljg1LDEuNzMsMS41MiwyLjg3LDEuOTUuOTYuMzcsMi4xLjU5LDMuMzYuNjNoMi4yN2MxLjI2LS4wNCwyLjM5LS4yNSwzLjM2LS42MywxLjEzLS40MywyLjEtMS4wOSwyLjg2LTEuOTUsMS41LTEuNzUsMi4xNy0zLjgsMi4xNy02LjZ2LTEuNDJjMC0yLjgtLjY2LTQuODUtMi4xNy02LjYtLjc2LS44Ni0xLjczLTEuNTItMi44Ni0xLjk1LS45Ny0uMzYtMi4xLS41OS0zLjM4LS42M2wtLjEzLS4wM2gtMi4wMiwwWk03Mi42NSwyODIuODJ2MTkuODVoMy42NnYtMTcuOWg2Ljg1YzIuNjUsMCw0LjgsMi4xNSw0LjgsNC43OHYxMy4xMmgzLjc0bC4wMy0xMC40YzAtMi44OS0uNjktNC45Ny0yLjIyLTYuNzgtLjc3LS44Ni0xLjc0LTEuNTQtMi45MS0xLjk5LTEuMDEtLjM2LTIuMTctLjYtMy40NS0uNjRoLS4xM3YtLjAzaC0xMC4zN1pNMTUwLjAzLDI4Mi44NGMtMS41NywwLTIuOTUuMjUtNC4xNS42OS0xLjIyLjQ1LTIuMjQsMS4xNi0zLjA1LDIuMDctMS4xOCwxLjQxLTEuMzUsMy4yNC0xLjU2LDUuNTVsLS4wNS42NS4wNCwxMC44NWgzLjYxbC4wNC0xMC42OGMwLTEuMjkuMTEtMi40NC4zNC0zLjQyLjI1LS45My42MS0xLjY3LDEuMDYtMi4xOS40My0uNTMsMS4wMi0uOTMsMS43My0xLjE3LjYtLjIsMS4zNy0uMywyLjI2LS4zaDEuNTZ2LTIuMWwtMS44NC4wM2gwWk0zOTIuNTQsMjgyLjgydjE5Ljg1aDMuNjd2LTE3LjloNi44NGMyLjYzLDAsNC44LDIuMTUsNC44LDQuNzh2MTMuMTJoMy43NGwuMDQtMTAuNGMwLTIuODktLjY5LTQuOTctMi4yMi02Ljc4LS43OC0uODYtMS43Ny0xLjU0LTIuOTQtMS45OS0xLS4zNi0yLjE3LS42LTMuNDUtLjY0aC0uMTN2LS4wM2gtMTAuMzZaTTMyMy44NCwyOTUuODRzLS4xNS0xLjUzLS4xNS0zLjEuMTYtMy4xLjE2LTMuMWMwLTIuNjcsMi4xOS00Ljg3LDQuODktNC44N2g2Ljk5djkuNTFsLS4wNCwxLjU3YzAsMi42My0yLjMzLDQuODgtNS4wOCw0Ljg4aC0xLjg5Yy0yLjY5LDAtNC44OC0yLjE5LTQuODgtNC44OU0zMjguNDUsMjgyLjc4bC0uMTEuMDNjLTEuMzIuMDctMi41LjI5LTMuNTQuNjYtMS4xOC40Ni0yLjE5LDEuMTQtMi45OCwyLjA1LTEuNTcsMS44NC0yLjI4LDMuOTctMi4yOCw2LjkxbC4xNCwyLjVjLjI1LDIuMDMuOTMsMy42NSwyLjEzLDUuMDUuNzguOSwxLjgsMS41OSwyLjk4LDIuMDUuNTYuMiwxLjE2LjMyLDEuNzMuNDQsMS4yNS4yNSwyLjQyLjI0LDMuNi4yNS42OSwwLDEuMzMsMCwxLjk4LS4xNGwuMDMtLjAzYy42OC0uMTQsMS4zNS0uMywyLS41My41NS0uMjEsMS4wMi0uNSwxLjQtLjczbC4yLS4xM3YxLjQ2aDMuNzV2LTE5Ljg1aC0xMS4wNCwwWk0xODkuMjQsMjk1LjA3Yy0uMjctMi40Ni0uNDEtNi44NywxLjQ5LTguOS44OC0uOTYsMi4xNC0xLjUsMy40My0xLjVoMS40OWMzLjgyLDAsNC43MiwzLjg3LDQuOTMsNS41MS4xNCwxLjI5LjM2LDMuNzgtLjA4LDUuOTgtLjIxLDEuMTItLjU2LDIuMDMtMS4wNSwyLjctLjg4LDEuMjEtMi4zLDEuOTQtMy44LDEuOTRoLTEuNWMtMy45MSwwLTQuNzUtNC00LjkyLTUuNzNNMTkzLjg3LDI4Mi43OGgtLjA5Yy0xLjI2LjA4LTIuNDEuMjktMy4zOC42NC0xLjE0LjQ0LTIuMSwxLjEtMi44NiwxLjk1LTEuNTIsMS43Ny0yLjE5LDMuODMtMi4xOSw2LjY0djEuNDFjMCwyLjgzLjY4LDQuODcsMi4xOSw2LjYzLjc1Ljg2LDEuNzEsMS41MiwyLjg2LDEuOTUuOTcuMzYsMi4xMS41OCwzLjM4LjYzaDIuMjljMS4yNi0uMDUsMi4zOS0uMjcsMy4zNi0uNjMsMS4xNC0uNDQsMi4xMi0xLjA5LDIuODctMS45NSwxLjUxLTEuNzcsMi4xOC0zLjgxLDIuMTgtNi42M3YtMS40MWMwLTIuODItLjY4LTQuODctMi4xOC02LjY0LS43Ni0uODUtMS43My0xLjUyLTIuODctMS45NS0uOTYtLjM2LTIuMS0uNTctMy4zNi0uNjNoLTIuMTlzMCwwLDAsMFpNMTExLjk0LDI4Mi42MWMtMS4yNC40Ni0yLC45OC0yLjc5LDEuODktMS42LDEuODItMS42LDQuNTksMCw2LjQ2LjguOSwxLjgyLDEuNjEsMi45OSwyLjA2LjguMjksMS43LjUsMi42Ny42bC4yLjAzYzEuMTYuMTIsMi40Ni4yNSwzLjMyLDEuMjIuOTIsMS4wNiwxLjEsMi4wNy41NiwyLjk5LTEuMiwyLjAyLTMuNDYsMi4zLTUuNDksMi4zaC00LjF2Mi41NWMuNzUuMDgsNS45MiwwLDYuNi0uMDgsMi43Ny0uMjksNC43NS0xLjE3LDYuMS0yLjcsMS4wNS0xLjE4LDEuNDQtMi44NiwxLjA1LTQuNDItLjE5LS43Ny0uNTYtMS40Ni0xLjA2LTIuMDMtLjgtLjkyLTEuODEtMS42Mi0zLjAxLTIuMDYtLjY2LS4yNC0xLjQ2LS4zNi0yLjMzLS40Ny0xLjk2LS4yNS00LjE2LS41Ni00LjY3LTIuODctLjMyLTEuNTIsMS4wNS0yLjc0LDIuNDctMy4yMS41Mi0uMTcsMS4xOC0uMjUsMS45Ny0uMjVoMy43OHYtMi40NWMtLjY2LDAtMS4zMy0uMDMtMi4wMi0uMDctLjc1LS4wMy0xLjUtLjA3LTIuMjUtLjA3LTEuNCwwLTIuNzcuMTItNC4wMi41OU0xMjYuNjksMjc2Ljk2bC0uMDUsMTcuMS4wNy42M2MuMTksMi4yMi4zMywzLjk3LDEuNDgsNS4zMi43Ny44OCwxLjc2LDEuNTUsMi45MSwxLjk4LDEuMTMuNDQsMi40Ni42NCw0LjA0LjY0aDEuNTd2LTEuOWgtMS40Yy0uNzUsMC0xLjQ4LS4xMi0yLjE0LS4zNC0uNjktLjIzLTEuMjQtLjYxLTEuNjYtMS4xMi0uNDQtLjQ5LS43Ni0xLjIxLTEuMDItMi4xLS4yMS0uOTYtLjMyLTIuMDItLjMyLTMuMjdsLS4wMy04LjUyaDUuOHYtMi41N2gtNS44MXYtNS44NWgtMy40NFpNMzQ1LjQ5LDI3Ni45NmwtLjA1LDE3LjEuMDcuNjRjLjE5LDIuMjIuMzQsMy45NiwxLjQ4LDUuMy43OC44OSwxLjc3LDEuNTcsMi45MywyLDEuMTMuNDMsMi40NS42Myw0LjA0LjYzaDEuNTd2LTEuOWgtMS40Yy0uNzUsMC0xLjQ2LS4xMi0yLjE0LS4zNHMtMS4yNC0uNi0xLjY3LTEuMTJjLS40My0uNDktLjc2LTEuMi0xLjAyLTIuMS0uMi0uOTMtLjMyLTIuMDMtLjMyLTMuMjdsLS4wMy04Ljg2aDUuOHYtMi4yMmgtNS44MWwtLjAzLTUuODVoLTMuNDNaTTUwLjQxLDI3Ni42OGwtMTAuMDQsMjAuMTVoLS4zN2wtLjAzLS4wNy0xMC4xOS0yMC4wOGgtNC4zdjI1Ljk2aDMuNjF2LTE4LjU5bDkuNDgsMTguNTloMS45NWw5LjU0LTE5LjE5LjczLTEuMzR2MjAuNTJoMy44NHYtMjUuOTZoLTQuMjIsMFpNNjIuMjcsMjc4LjQ2di42YzAsMSwuOCwxLjgsMS44LDEuOHMxLjc4LS44LDEuNzgtMS44di0uNmMwLS45Ny0uODEtMS43OC0xLjc4LTEuNzhzLTEuOC44MS0xLjgsMS43OE05OC44OCwyNzguNDZ2LjZjMCwxLC44MSwxLjgsMS44LDEuOHMxLjgtLjgsMS44LTEuOHYtLjZjMC0uOTctLjgxLTEuNzgtMS44LTEuNzhzLTEuOC44MS0xLjgsMS43OE0yNTUuMjUsMjk1Ljk1di02LjQxYzAtMi42MywyLjE0LTQuNzcsNC43OS00Ljc3aDYuODZ2MTUuOTZoLTYuODZjLTIuNjUsMC00Ljc5LTIuMTUtNC43OS00Ljc4TTI2Ni44OSwyNzYuNjh2Ni4xNWgtNy4xNWwtLjExLjAzYy0xLjMuMDUtMi40Ni4yNy0zLjQ1LjY0LTEuMTYuNDUtMi4xNSwxLjEzLTIuOTMsMi0xLjU0LDEuODEtMi4yMiwzLjg5LTIuMjIsNi43NnYuOThjMCwzLjY5LDEuMTgsNS41NSwyLjIyLDYuNzYuNzcuODksMS43NiwxLjU3LDIuOTMsMS45OSwxLC4zOSwyLjE1LjYsMy40NS42NWguMTN2LjAzaDEwLjc5di0yNS45OWgtMy42NlpNMzYwLjExLDI3OC40NnYuMTljMCwuOTcuOCwxLjc4LDEuOCwxLjc4czEuNzgtLjgxLDEuNzgtMS43OHYtLjE5YzAtLjk3LS44MS0xLjc4LTEuNzgtMS43OHMtMS44LjgxLTEuOCwxLjc4TTIzMC45OCwyNzYuNjd2MjUuOTdoMTcuNXYtMS44OWgtMTMuODZ2LTEwLjk5aDkuMjZ2LTEuOTloLTkuMjZ2LTguODhoMTMuODZ2LTIuMjJoLTE3LjUsMFpNMjE2LjY5LDI3Ni42NGMtMS41MiwwLTIuODguMjMtNC4wNC42OC0xLjE2LjQ0LTIuMTcsMS4xMi0yLjkzLDItMS4xNiwxLjM1LTEuMjksMy4xLTEuNDksNS4zbC0uMDUuNjMuMDQsMTcuMzhoMy40M2wuMDMtMTIuMjhoNS44di0yLjIyaC01Ljc5di0yLjczYzAtMS4yMi4xMS0yLjMxLjM0LTMuMjcuMjUtLjg4LjU5LTEuNTgsMS4wMS0yLjA5LjQzLS41Mi45OC0uOSwxLjY3LTEuMTMuNTItLjE3LDEuMTYtLjI1LDEuOTgtLjI3aC4xM3YuMDNoMS44M3YtMi4wM2gtMS45Ni4wMlpNNjYuMjIsMjQ3Ljc0YzAsMS44MywxLjQ5LDMuMywzLjMsMy4zczMuMy0xLjQ2LDMuMy0zLjMtMS40OS0zLjI4LTMuMy0zLjI4LTMuMywxLjQ4LTMuMywzLjI4TTc1LjcyLDI0Ny43NGMwLDEuODMsMS40OSwzLjMsMy4zLDMuM3MzLjMtMS40NiwzLjMtMy4zLTEuNDgtMy4yOC0zLjMtMy4yOC0zLjMsMS40OC0zLjMsMy4yOE0yOTEuNzIsMjI1LjAyYzAtNC4wOSwzLjMyLTcuNCw3LjQtNy40aDE0Ljk3djE0LjhoLTIyLjM3di03LjM5Wk0yOTguNjEsMjEyLjY4Yy03LjE0LDAtMTIuOTQsNS43OS0xMi45NCwxMi45M3YxMi4wNWgzNC40NnYtMjQuOTloLTIxLjUyWk0zMzEuMzUsMjEyLjY4bC0uMDcsMjYuNDZjMCwxLjY0LS4xNCwzLjEtLjQxLDQuMzItLjM0LDEuMTYtLjc4LDIuMDctMS4zMiwyLjcyLS41Mi42NC0xLjI0LDEuMTItMi4xLDEuMzktLjc2LjI1LTEuNzEuMzktMi44My4zOWgtLjEzbC4yOCwzLjI4aC4xMmMyLjA2LDAsMy45My0uMzIsNS41NS0uOTIsMS42LS42MSwyLjk4LTEuNTQsNC4wNC0yLjc3LDEuNzQtMi4wMywyLjc3LTQuODEsMy4wNi04LjIxbC0uMDQtMjYuNjZoLTYuMTZaTTM2My4xNSwyMTIuNjhsLS4wNSwyNi40NmMwLDEuNjQtLjE0LDMuMS0uNDMsNC4zMi0uMzMsMS4xNi0uNzcsMi4wNi0xLjMyLDIuNzItLjUyLjY0LTEuMjQsMS4xMi0yLjEsMS4zOS0uNzUuMjUtMS43LjM5LTIuODMuMzloLS4xM2wuMjksMy4yOGguMTFjMi4wNiwwLDMuOTMtLjMyLDUuNTYtLjkyLDEuNi0uNjEsMi45Ny0xLjU0LDQuMDQtMi43NywxLjczLTIuMDMsMi43Ny00LjgsMy4wNi04LjIxbC0uMDUtMjYuNjZoLTYuMTZaTTM4My4yNSwyMjUuMjJjMC00LjIsMy40LTcuNiw3LjYxLTcuNmgxNC41OXYuMmwtLjA0LDE0LjU5aC0yMi4xNnYtNy4yWk0zOTAuMzQsMjEyLjY4Yy03LjI2LDAtMTMuMTUsNS44Ny0xMy4xNSwxMy4xNHYxMS44NGgyOC4xOXYxLjQ2YzAsMS42NS0uMTMsMy4xLS40Myw0LjMzLS4zMywxLjE2LS43NiwyLjA3LTEuMywyLjczLS41Mi42My0xLjI0LDEuMS0yLjEsMS4zOC0uMzEuMTEtLjY5LjE3LTEuMDYuMjV2My4zNmMxLjQ4LS4xMiwyLjgzLS40MSw0LjA0LS44NSwxLjYyLS42MSwyLjk4LTEuNTQsNC4wNi0yLjc3LDEuNzMtMi4wMywyLjc3LTQuOCwzLjA3LTguMjFsLS4wMy0yNi42NmgtMjEuMzEsMFpNMzUuOTUsMjE4LjAyYzAtLjIxLjE5LS40LjM5LS40aDE3LjljLjI1LjA1LjQ4LjA4LjcyLjEzLDMuNjEuNjYsNi4yMiwzLjgsNi4yMiw3LjQ3djcuMmgtMjUuMThsLS4wNC0xNC40MWgwWk0yNDMuNDgsMTk5LjA0djMzLjM3aC0xNS4wNXYtMTkuNzRoLTYuMDN2MTkuNzRoLTYwLjE5di03LjAxYzAtNC4yOSwzLjUtNy43OSw3LjgxLTcuNzloMjUuNjh2LTQuOTRoLTI2LjIxYy03LjM3LDAtMTMuMzQsNS45Ny0xMy4zNCwxMy4zM3Y2LjQxaC00OC42M3YtMzMuMzdoLTUuOTZ2MzMuMzdoLTE2Ljc3di0xOS43NGgtNi4wM3YxOS43NGgtMTEuNGwtLjA0LTYuMDF2LS4wOGMwLTQuMjQtMS4zNC03LjYtMy45Ni05Ljk3LTIuMzQtMi4yMi01LjY3LTMuNDYtOS44OC0zLjY3aC0yMy44M2wuMDcsMjUuNDRjMCwxLjY0LS4xNSwzLjA4LS40NCw0LjMyLS4zMSwxLjE2LS43NiwyLjA3LTEuMjksMi43Mi0uNTMuNjQtMS4yNCwxLjEtMi4xLDEuMzktLjEyLjA0LS4yOC4wNS0uNDEuMDl2My40M2MxLjIyLS4xMywyLjM3LS40LDMuNC0uNzgsMS42MS0uNjEsMi45Ny0xLjU1LDQuMDYtMi43NywxLjczLTIuMDMsMi43Ny00LjgsMy4wNi04LjIxdi0uNjVoMjEzLjY5di0zOC42MmgtNi4yMlpNMjU4LjgyLDE5OS4wNHMtLjA4LjA1LS4wOC4wOHYzOC40NXMuMDQuMDguMDguMDhoNS44NXMuMDgtLjAzLjA4LS4wOHYtMzguNDVzLS4wNC0uMDgtLjA4LS4wOGgtNS44NVpNMzQ2Ljk1LDIzNy42NWg2LjAxdi0zOC42MWgtNi4wMXYzOC42MVpNMzYzLjAyLDIwMi4zNGMwLDEuODEsMS40OCwzLjMsMy4yOSwzLjNzMy4zLTEuNDksMy4zLTMuMy0xLjQ5LTMuMy0zLjMtMy4zLTMuMjksMS40OC0zLjI5LDMuM00yMTQuNzgsMjAyLjM0YzAsMS44LDEuNDgsMy4yOCwzLjMsMy4yOHMzLjI5LTEuNDksMy4yOS0zLjI4LTEuNDgtMy4zMS0zLjI5LTMuMzEtMy4zLDEuNDktMy4zLDMuMzFNMjI0LjI5LDIwMi4zNGMwLDEuOCwxLjQ4LDMuMjgsMy4zLDMuMjhzMy4yNy0xLjQ5LDMuMjctMy4yOC0xLjQ2LTMuMzEtMy4yNy0zLjMxLTMuMywxLjQ5LTMuMywzLjMxTTI5Ni4yMiwyMDIuMzRjMCwxLjgsMS40OSwzLjI4LDMuMywzLjI4czMuMjktMS40OSwzLjI5LTMuMjgtMS40Ni0zLjMxLTMuMjktMy4zMS0zLjMsMS40OS0zLjMsMy4zMU0zMDUuNzQsMjAyLjM0YzAsMS44LDEuNDksMy4yOCwzLjMsMy4yOHMzLjMtMS40OSwzLjMtMy4yOC0xLjQ5LTMuMzEtMy4zLTMuMzEtMy4zLDEuNDktMy4zLDMuMzFNMjE2LjM3LDE0MS4yM2MtLjA0LDEuNDUuNTksMi44NywxLjY2LDMuOTIsMS4wMSwxLjAyLDIuNDMsMS42NywzLjg3LDEuNjIsMS40Ni4wNCwyLjkxLS41NiwzLjk0LTEuNTgsMS4wNS0xLjA1LDEuNjQtMi41MSwxLjY0LTMuOTMsMC0xLjQ5LS41OS0yLjk0LTEuNi0zLjk3LTEuMDctMS4wNS0yLjQ3LTEuNTktMy45OC0xLjU5LTIuOSwwLTUuNTMsMi42My01LjUzLDUuNTNNMTQ1LjUsMTIwLjkxYy0yLjk3LDAtNS41MywyLjU3LTUuNTMsNS40NSwwLDEuNDguNTksMi45MiwxLjYsMy45MywxLjA1LDEuMDYsMi41LDEuNjQsMy45NCwxLjYxLDEuNDQuMDMsMi44My0uNTgsMy44Ni0xLjYxLDEuMDYtMS4wNSwxLjY0LTIuNDIsMS42NC0zLjg4cy0uNjItMi44OS0xLjY0LTMuODljLS45OC0uOTgtMi4zNC0xLjYxLTMuNzQtMS42MS0uMDQsMC0uMDgsMC0uMTIsME0yOTMuMjIsMTI1LjU5Yy0uMDMsMS40My41OSwyLjgzLDEuNjIsMy44NSwxLDEuMDEsMi40MSwxLjYyLDMuODgsMS42MnMyLjgzLS41OCwzLjktMS42MmMxLjAxLTEuMDIsMS42Mi0yLjQyLDEuNTgtMy44NS4wNC0xLjQ1LS41My0yLjg5LTEuNTgtMy45My0xLjAyLTEuMDItMi40Ny0xLjYyLTMuOTMtMS42Mi0yLjg5LDAtNS40NywyLjU4LTUuNDcsNS41NE0xOTYuMjIsMTEyLjk3Yy0zLjM0LjQxLTUuNjUsMy41LTUuMTksNi43OS40NiwzLjMsMy41LDUuNjYsNi44LDUuMTksMS4zOC0uMTksMi41OC0uNzcsMy40OC0xLjY3LDEuMzMtMS4zMywyLjAxLTMuMjEsMS43My01LjEzLS40LTMuMDUtMi45OS01LjI0LTUuOTYtNS4yNC0uMjksMC0uNTguMDMtLjg3LjA3TTI0MS4xOCwxMTcuMjdjLS40NywzLjMxLDEuODMsNi4zOSw1LjE5LDYuOCwxLjkzLjMsMy44LS4zNyw1LjEzLTEuNzEuOTEtLjksMS41Mi0yLjEsMS42OC0zLjQ3LjQ3LTMuMy0xLjg5LTYuMzQtNS4xOS02LjgtLjMtLjA0LS41OS0uMDctLjg4LS4wNy0yLjk1LDAtNS41NSwyLjIxLTUuOTQsNS4yNE0xMDguNjMsMTA2LjI4Yy0zLjgyLDIuMDEtNS4yNSw2Ljg1LTMuMiwxMC43MSwyLjA4LDMuODcsNi45LDUuMzMsMTAuNzcsMy4yNi42OC0uMzMsMS4yOS0uODUsMS44LTEuMzUsMi40Ni0yLjQ2LDMuMS02LjIyLDEuNC05LjM2LTEuNDQtMi42Ny00LjE4LTQuMi03LjAxLTQuMi0xLjI4LDAtMi41NS4zLTMuNzYuOTRNMzI0Ljg0LDEwOC42M2MtMi4wOCwzLjg3LS42MSw4LjcxLDMuMjQsMTAuNzYsMy4xNiwxLjcsNi45MiwxLjA3LDkuMzgtMS4zOS41LS41MiwxLjAxLTEuMTMsMS4zNS0xLjgxLDIuMDktMy44NS42Mi04LjY4LTMuMjYtMTAuNzUtMS4yLS42NC0yLjUtLjk2LTMuNzYtLjk2LTIuODMsMC01LjU2LDEuNTEtNi45NSw0LjE1TTcwLjI0LDk4LjE0bC0uMDQuMDVjLTQuMTUsMy4zMi00Ljk4LDkuNDEtMS42NywxMy42OCwzLjMyLDQuMjgsOS40Nyw1LjA0LDEzLjc1LDEuNzMuMzMtLjE5LjYyLS40OC45LS43NSwzLjQ1LTMuNDYsMy44Ny04Ljk5Ljc1LTEyLjkzLTEuOTMtMi40OC00LjgzLTMuNzktNy43NS0zLjc5LTIuMDgsMC00LjE4LjY2LTUuOTMsMi4wMU0zOS4zMyw5NS41NmMtNS4zLS4wOC0xMC40LDQuODctMTAuMzIsMTAuMzEsMCwyLjYxLDEuMDksNS4zLDIuOTgsNy4xOSwxLjk3LDEuOTcsNC42NiwzLjA2LDcuMzQsMi45OSwyLjY5LjA4LDUuMzEtMS4xLDcuMjEtMi45OSwxLjk2LTEuOTcsMy4xMy00LjU4LDMuMDUtNy4yOC4wOC0yLjY3LTEuMDktNS4yOS0zLjA1LTcuMjQtMS44My0xLjg0LTQuMzUtMi45OS02Ljk1LTIuOTktLjA4LDAtLjE3LDAtLjI1LDBNMzYxLjQxLDk5LjAxbC0uMDguMDdjLTMuMjQsNC4yMS0yLjQ5LDEwLjM3LDEuOCwxMy42OCwzLjk0LDMuMTEsOS40NywyLjcsMTIuOTMtLjc1LjI3LS4yOC41Ni0uNTcuNzYtLjkxLDMuMzEtNC4yOCwyLjU1LTEwLjQxLTEuNzMtMTMuNzMtMS43OC0xLjM4LTMuODgtMi4wNS01Ljk2LTIuMDUtMi45LDAtNS43NywxLjI5LTcuNzEsMy42OU0zOTQuNjIsMTA1LjAyYy0uMDgsMi42OCwxLjA5LDUuMywyLjk4LDcuMiwxLjk3LDEuOTUsNC41OSwzLjEyLDcuMjcsMy4wNSwyLjcuMDgsNS4zMS0xLjA5LDcuMjctMy4wNXMzLjA2LTQuNTIsMi45OC03LjJjLjA4LTIuNjgtMS4wMS01LjM3LTIuOTgtNy4zMy0xLjg5LTEuODktNC41Ny0yLjk4LTcuMTktMi45OC0uMDQsMC0uMDgsMC0uMTIsMC01LjQxLDAtMTAuMjgsNS4wNi0xMC4yLDEwLjMxTTE2Ny4zOCw5My43OGMtMy44NywxLjA5LTYuMTIsNS4wOS00Ljk5LDkuMDEsMS4wOCwzLjg0LDUuMDksNi4xLDguOTUsNS4wMywxLjI0LS40MSwyLjI2LTEuMDQsMy4xNC0xLjksMS44LTEuOCwyLjYyLTQuNDgsMS44NC03LjEtLjg5LTMuMi0zLjgyLTUuMy02Ljk4LTUuMy0uNjUsMC0xLjMuMDgtMS45Ni4yN00yNjcuODgsOTcuOThjLTEuMDcsMy44NSwxLjE4LDcuODcsNS4wNCw4Ljk0LDIuNjIuNzYsNS4zLS4wNSw3LjEtMS44Ni44OC0uODYsMS41LTEuODksMS45LTMuMTIsMS4wNy0zLjg3LTEuMTgtNy44OC01LjA0LTguOTQtLjY5LS4xOS0xLjM4LS4yOS0yLjA2LS4yOS0zLjE4LDAtNi4wNiwyLjA5LTYuOTUsNS4yOE0yMjEuOSw5MC44NmMtMy4xOSwwLTYuMDgsMi44OS02LjA4LDYuMDctLjA0LDEuNjIuNiwzLjIxLDEuNzYsNC4zNywxLjEzLDEuMTMsMi42OSwxLjczLDQuMzIsMS43M3MzLjItLjYxLDQuMzQtMS43M2MxLjE2LTEuMTcsMS43Ny0yLjcyLDEuNzctNC4zN3MtLjY0LTMuMTYtMS43Ny00LjI4Yy0xLjEzLTEuMTMtMi42NS0xLjgyLTQuMi0xLjgyLS4wNCwwLS4wOCwwLS4xMywwTTEzNi4yNCw3OS4zN2MtMy45OCwxLjczLTUuODQsNi4zOC00LjE1LDEwLjQzLDEuOCw0LjA0LDYuNSw1LjgzLDEwLjQ5LDQuMDkuOTYtLjQsMS43NC0uOTYsMi40Ni0xLjY5LDIuMTktMi4xOSwyLjk5LTUuNjUsMS43LTguNzYtMS4zNC0yLjk5LTQuMjctNC43NC03LjMzLTQuNzQtMS4wNiwwLTIuMTQuMjEtMy4xNy42Nk0yOTcuNTUsODIuNmMtMS43MywzLjk4LjA3LDguNyw0LjEsMTAuNDksMy4wOCwxLjI5LDYuNTcuNSw4Ljc1LTEuNjguNzMtLjczLDEuMjktMS41MSwxLjY5LTIuNDYsMS43My0zLjk4LS4wNy04LjY5LTQuMS0xMC41LTEuMDItLjQxLTIuMDYtLjYyLTMuMS0uNjItMy4xLDAtNi4wMywxLjc4LTcuMzMsNC43N00xOTQuMTIsNzEuNjJjLTMuNTIuODQtNS43MSw0LjMxLTQuOTIsNy44OC44OCwzLjQ4LDQuNCw1LjcxLDcuOTQsNC44OCwxLjIxLS4yOSwyLjMzLS45NCwzLjExLTEuNzEsMS41Ny0xLjU5LDIuMzEtMy45MSwxLjgxLTYuMTgtLjcyLTMuMDMtMy40My01LjA2LTYuNDEtNS4wNi0uNSwwLTEuMDIuMDctMS41My4xOU0yNDIuMjMsNzUuNjNjLS44NSwzLjUzLDEuMzUsNy4xMSw0Ljg2LDcuOTMsMi4yOC41Miw0LjU5LS4yMyw2LjE4LTEuOC44LS44LDEuNDQtMS45LDEuNzMtMy4xMS44Mi0zLjUzLTEuNC03LjA2LTQuODctNy45My0uNS0uMTItMS0uMTYtMS40OC0uMTYtMy4wMiwwLTUuNzEsMi4wMy02LjQxLDUuMDhNMTAyLjc1LDY4LjZjLTQuMzgsMi43NS01Ljc5LDguNi0zLjEsMTMuMDQsMi43Nyw0LjUzLDguNjIsNS45NCwxMy4xMywzLjE4LjY5LS40MSwxLjI5LS44OSwxLjc2LTEuMzUsMy4xLTMuMSwzLjc2LTcuOTQsMS40MS0xMS43OC0xLjg1LTIuOS00Ljk5LTQuNTEtOC4yLTQuNTEtMS43LDAtMy40My40NS01LDEuNDFNMzI4LjMxLDcwLjhjLTIuNzcsNC41MS0xLjM1LDEwLjM1LDMuMSwxMy4yLDMuODMsMi4zNSw4LjY4LDEuNjksMTEuNzgtMS40Mi40Ni0uNDYuOTMtMS4wNiwxLjM1LTEuNzMsMi43NS00LjUyLDEuMzUtMTAuMzctMy4xNy0xMy4xMy0xLjU0LS45My0zLjIzLTEuMzctNC45Mi0xLjM3LTMuMiwwLTYuMzQsMS41OS04LjE1LDQuNDZNNjcuNjgsNjMuMjdjLTQuMzgsMy42NC01LjAyLDEwLjExLTEuNCwxNC40NywzLjU2LDQuNDIsMTAuMDQsNS4wOCwxNC40MiwxLjQ1bC4wNy4wOGMuMjktLjMuNTItLjUyLjczLS43NCwzLjcxLTMuNzEsNC4wNy05LjczLjczLTEzLjgxLTIuMDYtMi40Ny01LjAzLTMuNzUtOC4wMi0zLjc1LTIuMjksMC00LjU5Ljc1LTYuNTIsMi4yOU0zNjEuMTIsNjMuODJjLTMuNTQsNC40My0yLjksMTAuOSwxLjQ2LDE0LjU0LDQuMDcsMy4zNSwxMC4wOSwyLjk2LDEzLjgxLS43My4yLS4yMy40NC0uNDQuNzMtLjc0bC0uMDgtLjA3YzMuNjQtNC4zNiwyLjk4LTEwLjgyLTEuNDUtMTQuMzktMS45LTEuNTgtNC4yMi0yLjM1LTYuNTEtMi4zNS0yLjk3LDAtNS45MiwxLjI5LTcuOTgsMy43M00yOS4wMSw3MC4zMmMwLDIuOSwxLjIyLDUuODksMy4zOCw4LjA3LDIuMSwyLjEsNS4xMSwzLjMyLDguMSwzLjIzLDIuOTguMDgsNS45Ny0xLjEzLDguMDctMy4yMywyLjE4LTIuMTgsMy4zMS01LjA4LDMuMzItOC4xNSwwLTMuMDgtMS4yMi01LjktMy4zMi04LTIuMTgtMi4xOC01LjAxLTMuMzktOC4wNy0zLjM5aC0uMTRjLTYuMDEsMC0xMS4zNCw1LjUzLTExLjM0LDExLjQ3TTM5Mi4zMyw2OS40OGMwLDMuMDYsMS4yMSw1Ljg3LDMuMzksOC4wNywyLjA5LDIuMSw0LjkyLDMuMyw3Ljk5LDMuMzEsMy4wNywwLDUuOTctMS4xMyw4LjE2LTMuMzEsMi4xLTIuMSwzLjMxLTUuMDgsMy4yMi04LjA3LjA4LTIuOTktMS4xMy01Ljk5LTMuMjItOC4wOC0yLjE4LTIuMTgtNS4xNy0zLjM5LTguMDctMy4zOS02LDAtMTEuNTYsNS40MS0xMS40OCwxMS40N00xNjQuNTksNTQuMDljLTQsMS41LTYuMDksNS45OS00LjYsMTAuMDEsMS40MiwzLjk1LDUuODcsNi4wNyw5Ljg3LDQuNmwuMDcuMDVjMS4wOC0uNDQsMi4wMi0xLjA1LDIuNzktMS44MiwyLjA5LTIuMDcsMi44My01LjI1LDEuODEtOC4xNi0xLjEyLTMuMTgtNC4xMS01LjE0LTcuMjgtNS4xNC0uODksMC0xLjc4LjE1LTIuNjYuNDdNMjY5LjY1LDU3Ljg5Yy0xLjQ5LDQsLjYxLDguNTEsNC42Nyw5LjkzLDIuOTEsMS4wMiw2LjA5LjI3LDguMTctMS44MS43Ny0uNzcsMS4zNy0xLjcxLDEuODItMi43OWwtLjA3LS4wN2MxLjQ5LTQtLjY1LTguNDQtNC42LTkuODYtLjg4LS4zMy0xLjc4LS40OC0yLjY2LS40OC0zLjE3LDAtNi4xNywxLjk1LTcuMzMsNS4wOE0xMzIuNzgsNDAuNTJjLTQuOTksMi41Ny02Ljk5LDguNTYtNC41LDEzLjYyLDIuNSw0LjkzLDguNjQsNi45NCwxMy41Nyw0LjQ0Ljk4LS41OCwxLjg1LTEuMTYsMi41Ny0xLjg2LDIuOTktMywzLjkyLTcuNzgsMS44NC0xMS43LTEuNzEtMy41NC01LjI5LTUuNTctOC45OC01LjU3LTEuNTIsMC0zLjA2LjM2LTQuNSwxLjA3TTI5Ny44OSw0NC4yMmMtMi41LDQuOTItLjQ5LDExLjA0LDQuNDgsMTMuNDYsMy45MywyLjA3LDguNzEsMS4xNCwxMS43Mi0xLjg1LjcxLS43LDEuMjktMS41NywxLjg1LTIuNTUsMi41LTQuOTIuNDktMTEuMDYtNC40My0xMy41Ni0xLjQ4LS43My0zLjA0LTEuMDctNC41Ni0xLjA3LTMuNzEsMC03LjI1LDIuMDMtOS4wNiw1LjU3TTk5LjYxLDMxLjVjLTUuNDMsMy42LTYuOTMsMTAuOTEtMy4zNCwxNi4zNSwzLjc1LDUuNDIsMTEuMDEsNi44NSwxNi40NSwzLjI2LjY4LS4zMiwxLjI1LS45LDEuNzQtMS40MSwzLjkzLTMuOTIsNC43Ni0xMC4wOSwxLjUxLTE0Ljg2LTIuMjctMy40My02LjA0LTUuMjktOS44Ny01LjI5LTIuMjQsMC00LjUuNjMtNi40OSwxLjk1TTMyOC4yNiwzMy45NWMtMy41OSw1LjQyLTIuMDgsMTIuNzcsMy4zNSwxNi4zNiw0Ljc1LDMuMjQsMTAuOTMsMi40MSwxNC44Ni0xLjUxLjQ5LS41LDEuMDgtMS4wOCwxLjQxLTEuNzUsMy41OS01LjQxLDIuMTctMTIuNjctMy4yNi0xNi40NC0yLTEuMzItNC4yNS0xLjk1LTYuNDktMS45NS0zLjgzLDAtNy42MSwxLjg2LTkuODgsNS4yOU02Ni42MiwyNi45NmMtNS4wMSw0LjE3LTUuNiwxMS42LTEuNDIsMTYuNiw0LjI1LDQuOTIsMTEuNjgsNS41LDE2LjY5LDEuMzVsLjY4LS42OGM0LjM1LTQuMzMsNC42Ni0xMS4xOC42OC0xNi4wMi0yLjM1LTIuNzEtNS42NS00LjExLTguOTYtNC4xMS0yLjcyLDAtNS40NC45NC03LjY2LDIuODZNMzYxLjA0LDI2Ljk3Yy00LjI1LDQuOTMtMy42NywxMi4zNSwxLjI1LDE2LjYxLDQuODMsNCwxMS42NywzLjY3LDE2LjAzLS42OC4yNS0uMjUuNDEtLjQxLjY2LS42Niw0LjE1LTUsMy41OS0xMi40NC0xLjMzLTE2LjY4LTIuMjQtMS44Ni00Ljk2LTIuNzctNy42NS0yLjc3LTMuMzUsMC02LjY2LDEuNDEtOC45OCw0LjE5TTQxLjk1LDE4LjA3Yy02LjctLjA5LTEyLjk2LDYuMTUtMTIuOTQsMTIuOTMtLjA5LDMuMzksMS4yOCw2Ljc4LDMuNzYsOS4yNiwyLjM5LDIuMzksNS43OSwzLjc2LDkuMjgsMy43NnM2LjctMS4zOCw5LjA5LTMuNzZjMi40Ny0yLjQ3LDMuODYtNS44NywzLjc2LTkuMjYuMDgtMy40LTEuNC02LjctMy43Ni05LjA5LTIuNDEtMi40MS01LjU4LTMuODUtOC44Ny0zLjg1aC0uMzJNNDAyLjA4LDE4LjA3Yy02Ljc4LDAtMTMuMDQsNi4yMy0xMi45NCwxMi45My0uMDksMy40LDEuMzcsNi42OSwzLjg2LDkuMTgsMi4zOSwyLjM4LDUuNjksMy44NCw5LjA5LDMuNzYsMy4zOS4wOCw2LjgtMS4yOSw5LjI3LTMuNzYsMi4zOS0yLjM5LDMuNzYtNS43OCwzLjc2LTkuMDksMC0zLjQ5LTEuMzYtNi44OS0zLjc2LTkuMjgtMi40MS0yLjM5LTUuNjgtMy43NS04Ljk1LTMuNzVoLS4zM1oiLz4KICAgIDwvY2xpcFBhdGg+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImxpbmVhci1ncmFkaWVudCIgeDE9Ii0xNDQ0LjczIiB5MT0iLTEzNi43OCIgeDI9Ii0xNDM0LjAyIiB5Mj0iLTEzNi43OCIgZ3JhZGllbnRUcmFuc2Zvcm09InRyYW5zbGF0ZSg1MjYwMi45OCA1MTQzLjQ2KSBzY2FsZSgzNi4zOSkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjM2I4M2I3Ii8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjMyIiBzdG9wLWNvbG9yPSIjM2Y4ZmE1Ii8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjk3IiBzdG9wLWNvbG9yPSIjNGJhZjc4Ii8+CiAgICAgIDxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzRjYjE3NiIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+CiAgPGcgaWQ9IkxheWVyXzEtMiI+CiAgICA8ZyBjbGFzcz0ic3QyIj4KICAgICAgPHJlY3QgY2xhc3M9InN0MSIgeD0iMjUuNDciIHk9IjE3Ljk3IiB3aWR0aD0iMzg5LjcyIiBoZWlnaHQ9IjI5Ni4wNyIvPgogICAgPC9nPgogIDwvZz4KPC9zdmc+"
            class="ministry-logo"
            alt="Ø´Ø¹Ø§Ø± Ø§Ù„ÙˆØ²Ø§Ø±Ø©"
          />

          <div
            class="header-text"
            style="
              color: var(--accent-color);
              font-size: 14px;
              font-weight: bold;
            "
            id="out_school"
          ></div>
        </div>

        <div class="header-col header-left">
          <div class="header-text">
            Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ: <span id="out_year"></span>
          </div>
          <div class="header-text">
            Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ: <span id="out_term"></span>
          </div>
        </div>
      </div>

      <div class="report-title-wrapper">
        <h1 class="report-main-title" id="out_report_title">
          ØªÙ‚Ø±ÙŠØ± ØªØ­Ù„ÙŠÙ„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨
        </h1>
      </div>

      <div class="info-bar">
        <div>Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ: <span id="out_grade">--</span></div>
        <div>Ø§Ù„ÙØµÙ„: <span id="out_section">--</span></div>
        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨: <span id="out_total_students">0</span></div>
      </div>

      <div id="tablesContainer"></div>

      <div id="statsTableContainer"></div>

      <div class="chart-section">
        <div class="chart-container">
          <canvas id="gradesChart"></canvas>
        </div>
      </div>

      <div class="footer-section">
        <div class="signature-box">
          <div class="signature-title">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</div>
          <div
            class="signature-line"
            id="out_date"
            style="border: none; border-bottom: 1px dotted #999"
          ></div>
        </div>
        <div class="signature-box">
          <div class="signature-title">Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
          <div class="signature-line" id="out_principal"></div>
        </div>
      </div>
    </div>

    <script>
      // ==========================================
      // ÙƒÙˆØ¯ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„ØªØ´ØºÙŠÙ„
      // ==========================================
      const gradesOrder = ["Ù…Ù…ØªØ§Ø²", "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹", "Ø¬ÙŠØ¯", "Ù…Ù‚Ø¨ÙˆÙ„", "Ø¶Ø¹ÙŠÙ"];
      const gradeColors = {
        Ù…Ù…ØªØ§Ø²: "#059669",
        "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹": "#2563eb",
        Ø¬ÙŠØ¯: "#0891b2",
        Ù…Ù‚Ø¨ÙˆÙ„: "#d97706",
        Ø¶Ø¹ÙŠÙ: "#dc2626",
      };
      const IGNORED_SUBJECTS = [
        "Ø§Ù„Ù…ÙˆØ§Ø¸Ø¨Ø©",
        "Ø§Ù„Ø³Ù„ÙˆÙƒ",
        "Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹",
        "Ø§Ù„Ù†ØªÙŠØ¬Ø©",
        "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¨Ø¯Ù†ÙŠØ©",
        "Ø§Ù„ÙÙ†ÙŠØ©",
      ];
      const STORAGE_KEY = "analysis_settings_v26";

      let globalSubjects = [];
      let globalCounts = {};
      let subjectTotals = {};
      let subjectScores = {};

      window.onload = function () {
        loadSettings();
        updateUI();
      };

      // --- Settings ---
      function saveSettings() {
        const settings = {
          right1: document.getElementById("inp_right1").value,
          right2: document.getElementById("inp_right2").value,
          right3: document.getElementById("inp_right3").value,
          school: document.getElementById("inp_school").value,
          reportTitle: document.getElementById("inp_report_title").value,
          year: document.getElementById("inp_year").value,
          term: document.getElementById("inp_term").value,
          grade: document.getElementById("inp_grade").value,
          section: document.getElementById("inp_section").value,
          principal: document.getElementById("inp_principal").value,
          date: document.getElementById("inp_date").value,
          maxScore: document.getElementById("inp_max_score").value,
        };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
        alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ…");
      }

      function loadSettings() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          const s = JSON.parse(saved);
          if (s.right1) document.getElementById("inp_right1").value = s.right1;
          if (s.right2) document.getElementById("inp_right2").value = s.right2;
          if (s.right3) document.getElementById("inp_right3").value = s.right3;
          if (s.school) document.getElementById("inp_school").value = s.school;
          if (s.reportTitle)
            document.getElementById("inp_report_title").value = s.reportTitle;
          if (s.year) document.getElementById("inp_year").value = s.year;
          if (s.term) document.getElementById("inp_term").value = s.term;
          if (s.grade) document.getElementById("inp_grade").value = s.grade;
          if (s.section)
            document.getElementById("inp_section").value = s.section;
          if (s.principal)
            document.getElementById("inp_principal").value = s.principal;
          if (s.date) document.getElementById("inp_date").value = s.date;
          if (s.maxScore)
            document.getElementById("inp_max_score").value = s.maxScore;
          updateUI();
        }
      }

      function clearSettings() {
        if (confirm("Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŸ")) {
          localStorage.removeItem(STORAGE_KEY);
          location.reload();
        }
      }

      function newAnalysis() {
        if (confirm("Ø¨Ø¯Ø¡ ØªØ­Ù„ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ ÙˆÙ…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ")) {
          globalSubjects = [];
          globalCounts = {};
          subjectTotals = {};
          subjectScores = {};
          document.getElementById("tablesContainer").innerHTML = "";
          document.getElementById("statsTableContainer").innerHTML = "";
          document.getElementById("out_total_students").innerText = "0";
          if (window.myChart) window.myChart.destroy();
          document.getElementById("fileInput").value = "";
        }
      }

      function updateUI() {
        const mapping = {
          right1: "right1",
          right2: "right2",
          right3: "right3",
          school: "school",
          report_title: "report_title",
          year: "year",
          term: "term",
          grade: "grade",
          section: "section",
          principal: "principal",
          date: "date",
        };
        for (let key in mapping) {
          const el = document.getElementById("out_" + mapping[key]);
          const inp = document.getElementById("inp_" + key);
          if (el && inp) {
            // Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠ Ù‡Ù†Ø§:
            // Ù†Ù…Ø±Ø± Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¹Ø¨Ø± Ø¯Ø§Ù„Ø© toArabicNumerals Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ø±Ø¶
            el.innerText = toArabicNumerals(inp.value);
          }
        }
      }

      // --- File Processing ---
      async function handleFiles(files) {
        if (!files || files.length === 0) return;
        for (let i = 0; i < files.length; i++) {
          await readSingleFile(files[i]);
        }
        updateReport();
      }

      function readSingleFile(file) {
        return new Promise((resolve) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: "array" });
            processWorkbook(workbook);
            resolve();
          };
          reader.readAsArrayBuffer(file);
        });
      }

      function processWorkbook(workbook) {
        let processedAsMulti = false;
        workbook.SheetNames.forEach((sheetName) => {
          const sheet = workbook.Sheets[sheetName];
          const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
          let isMulti = false;
          for (let r = 0; r < Math.min(json.length, 15); r++) {
            const rowStr = JSON.stringify(json[r] || []);
            if (
              rowStr.includes("Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©") ||
              (rowStr.includes("Ø§Ù„Ù…Ø§Ø¯Ø©") && rowStr.includes("Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"))
            ) {
              isMulti = true;
              break;
            }
          }
          if (isMulti) {
            processMultiSubjectSheet(json);
            processedAsMulti = true;
          }
        });

        if (!processedAsMulti) {
          processStandardSheet(workbook.Sheets[workbook.SheetNames[0]]);
        }
      }

      function processMultiSubjectSheet(json) {
        let subjectRowIdx = -1,
          maxScoreRowIdx = -1,
          headerRowIdx = -1;
        for (let r = 0; r < Math.min(json.length, 25); r++) {
          const rowStr = (json[r] || []).join(" ");
          if (rowStr.includes("Ø§Ù„Ù…Ø§Ø¯Ø©") && subjectRowIdx === -1)
            subjectRowIdx = r;
          if (rowStr.includes("Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©") && maxScoreRowIdx === -1)
            maxScoreRowIdx = r;
          if (rowStr.includes("Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨") && headerRowIdx === -1)
            headerRowIdx = r;
        }
        if (subjectRowIdx === -1) return;

        const dataStartIdx =
          headerRowIdx !== -1
            ? headerRowIdx + 1
            : maxScoreRowIdx !== -1
              ? maxScoreRowIdx + 1
              : subjectRowIdx + 2;
        const subjects = json[subjectRowIdx];
        const maxScores = maxScoreRowIdx !== -1 ? json[maxScoreRowIdx] : [];

        for (let c = 1; c < subjects.length; c++) {
          let subjectName = subjects[c];
          if (!subjectName) continue;
          const safeKey = initSubject(subjectName);
          if (safeKey === "skip") continue;
          let maxScore = 15;
          if (maxScores && maxScores[c]) {
            const parsed = parseFloat(maxScores[c]);
            if (!isNaN(parsed) && parsed > 0) maxScore = parsed;
          }
          for (let r = dataStartIdx; r < json.length; r++) {
            const row = json[r];
            if (!row || !row[0]) continue;
            const val = row[c];
            if (val !== undefined && val !== null && val !== "") {
              const score = parseFloat(val);
              if (!isNaN(score)) calculateAndStore(safeKey, score, maxScore);
            }
          }
        }
      }

      function processStandardSheet(sheet) {
        const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        const userMaxScore =
          parseFloat(document.getElementById("inp_max_score").value) || 100;
        if (json.length < 2) return;
        const headerRow = json[0];
        for (let c = 1; c < headerRow.length; c++) {
          const subjectName = headerRow[c];
          if (!subjectName) continue;
          const safeKey = initSubject(subjectName);
          if (safeKey === "skip") continue;
          for (let r = 1; r < json.length; r++) {
            const row = json[r];
            if (!row) continue;
            const val = row[c];
            if (val !== undefined && val !== null) {
              const score = parseFloat(val);
              if (!isNaN(score))
                calculateAndStore(safeKey, score, userMaxScore);
            }
          }
        }
      }

      function initSubject(subject) {
        subject = (subject + "").trim();
        if (IGNORED_SUBJECTS.some((ignored) => subject.includes(ignored)))
          return "skip";
        subject = subject.replace(/_/g, " ").replace(/[0-9]/g, "").trim();
        if (subject.length < 2) return "skip";
        if (!globalSubjects.includes(subject)) {
          globalSubjects.push(subject);
          globalCounts[subject] = {
            Ø¶Ø¹ÙŠÙ: 0,
            Ù…Ù‚Ø¨ÙˆÙ„: 0,
            Ø¬ÙŠØ¯: 0,
            "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹": 0,
            Ù…Ù…ØªØ§Ø²: 0,
          };
          subjectTotals[subject] = 0;
          subjectScores[subject] = [];
        }
        return subject;
      }

      function calculateAndStore(subject, score, maxScore) {
        const pct = (score / maxScore) * 100;
        let grade = "Ø¶Ø¹ÙŠÙ";
        if (pct >= 90) grade = "Ù…Ù…ØªØ§Ø²";
        else if (pct >= 80) grade = "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹";
        else if (pct >= 70) grade = "Ø¬ÙŠØ¯";
        else if (pct >= 50) grade = "Ù…Ù‚Ø¨ÙˆÙ„";
        globalCounts[subject][grade]++;
        subjectTotals[subject]++;
        subjectScores[subject].push(score);
      }

      // --- Rendering ---
      function updateReport() {
        let maxStudents = 0;
        globalSubjects.forEach((s) => {
          if (subjectTotals[s] > maxStudents) maxStudents = subjectTotals[s];
        });
        // Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: Ø¥Ø¶Ø§ÙØ© toArabicNumerals
        document.getElementById("out_total_students").innerText =
          toArabicNumerals(maxStudents);
        renderTables();
        renderStatsTable();
        renderChart();
      }

      function renderTables() {
        const container = document.getElementById("tablesContainer");
        if (globalSubjects.length === 0) {
          container.innerHTML =
            "<p style='text-align:center; color:#94a3b8;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶.</p>";
          return;
        }

        // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ (ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡ Ù„ÙŠØ¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)
        let htmlCounts = `
          <div class="table-section">
            <div class="section-title">Ø£ÙˆÙ„Ø§Ù‹: ØªÙˆØ²ÙŠØ¹ Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø­Ø³Ø¨ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±Ø§Øª</div>
            <table>
              <thead class="header-counts">
                <tr><th style="width: 25%;">Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</th>${gradesOrder.map((g) => `<th>${g}</th>`).join("")}<th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th></tr>
              </thead>
              <tbody>`;
        globalSubjects.forEach((sub) => {
          const total = subjectTotals[sub] || 0;
          let tr = `<tr><td style="font-weight:bold; background:#f8fafc;">${sub}</td>`;
          gradesOrder.forEach((g) => {
            // Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±Ù‚Ù…
            tr += `<td class="grade-cell">${toArabicNumerals(globalCounts[sub][g])}</td>`;
          });
          // Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹
          tr += `<td style="font-weight:bold; background:#e2e8f0;">${toArabicNumerals(total)}</td></tr>`;
          htmlCounts += tr;
        });
        htmlCounts += `</tbody></table></div>`;

        // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†Ø³Ø¨ (ÙƒØ§Ù† Ø³Ù„ÙŠÙ…Ø§Ù‹ØŒ Ù„ÙƒÙ† Ù†Ø¶Ø¹Ù‡ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆØ§ÙÙ‚)
        let htmlPcts = `
          <div class="table-section">
            <div class="section-title">Ø«Ø§Ù†ÙŠØ§Ù‹: Ù†Ø³Ø¨ ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±Ø§Øª (%)</div>
            <table>
              <thead class="header-percents">
                <tr><th style="width: 25%;">Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</th>${gradesOrder.map((g) => `<th>${g}</th>`).join("")}</tr>
              </thead>
              <tbody>`;
        globalSubjects.forEach((sub) => {
          const total = subjectTotals[sub] || 1;
          let tr = `<tr><td style="font-weight:bold; background:#f8fafc;">${sub}</td>`;
          gradesOrder.forEach((g) => {
            const pct = ((globalCounts[sub][g] / total) * 100).toFixed(1) + "%";
            tr += `<td class="percent-cell">${toArabicNumerals(pct)}</td>`;
          });
          tr += `</tr>`;
          htmlPcts += tr;
        });
        htmlPcts += `</tbody></table></div>`;
        container.innerHTML = htmlCounts + htmlPcts;
      }

      function renderStatsTable() {
        const container = document.getElementById("statsTableContainer");
        let html = "";

        html += `
        <div class="table-section">
            <div class="section-title">Ø«Ø§Ù„Ø«Ø§Ù‹: Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø©</div>
            <table>
                <thead class="header-stats-1">
                    <tr><th style="width: 25%;">Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</th><th>Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠ</th><th>Ø§Ù„ÙˆØ³ÙŠØ·</th><th>Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠ</th><th>Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­</th></tr>
                </thead>
                <tbody>`;
        globalSubjects.forEach((sub) => {
          const scores = subjectScores[sub] || [];
          const mean = calcMean(scores);
          const median = calcMedian(scores);
          const stdDev = calcStdDev(scores);
          const total = subjectTotals[sub] || 1;
          const weak = globalCounts[sub]["Ø¶Ø¹ÙŠÙ"] || 0;
          const passRate = (((total - weak) / total) * 100).toFixed(1) + "%";
          html += `<tr><td style="font-weight:bold;">${sub}</td><td>${toArabicNumerals(mean)}</td><td>${toArabicNumerals(median)}</td><td>${toArabicNumerals(stdDev)}</td><td style="font-weight:bold; color:var(--success-color); direction:ltr;">${toArabicNumerals(passRate)}</td></tr>`;
        });
        html += `</tbody></table></div>`;

        html += `
        <div class="table-section">
            <div class="section-title">Ø±Ø§Ø¨Ø¹Ø§Ù‹: Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ù…Ø¯Ù‰</div>
            <table>
                <thead class="header-stats-2">
                    <tr><th style="width: 25%;">Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</th><th>Ø£Ø¹Ù„Ù‰ Ø¯Ø±Ø¬Ø©</th><th>Ø£Ù‚Ù„ Ø¯Ø±Ø¬Ø©</th><th>Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙŠØ² (Ù…Ù…ØªØ§Ø²)</th><th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø¹Ù</th></tr>
                </thead>
                <tbody>`;
        globalSubjects.forEach((sub) => {
          const scores = subjectScores[sub] || [];
          const max = scores.length ? Math.max(...scores) : 0;
          const min = scores.length ? Math.min(...scores) : 0;
          const total = subjectTotals[sub] || 1;
          const exc = globalCounts[sub]["Ù…Ù…ØªØ§Ø²"] || 0;
          const weak = globalCounts[sub]["Ø¶Ø¹ÙŠÙ"] || 0;
          const strengthRate = ((exc / total) * 100).toFixed(1) + "%";
          const weaknessRate = ((weak / total) * 100).toFixed(1) + "%";
          html += `<tr><td style="font-weight:bold;">${sub}</td><td>${toArabicNumerals(max)}</td><td>${toArabicNumerals(min)}</td><td style="color:var(--success-color); font-weight:bold; direction:ltr;">${toArabicNumerals(strengthRate)}</td><td style="color:var(--danger-color); font-weight:bold; direction:ltr;">${toArabicNumerals(weaknessRate)}</td></tr>`;
        });
        html += `</tbody></table></div>`;
        container.innerHTML = html;
      }

      function renderChart() {
        const ctx = document.getElementById("gradesChart").getContext("2d");
        if (window.myChart) window.myChart.destroy();
        Chart.defaults.font.family = "'Cairo', sans-serif";
        Chart.defaults.font.size = 13;

        const datasets = gradesOrder
          .slice()
          .reverse()
          .map((g) => ({
            label: g,
            data: globalSubjects.map((s) => globalCounts[s][g]),
            backgroundColor: gradeColors[g],
            borderRadius: 4,
            barPercentage: 0.7,
          }));

        window.myChart = new Chart(ctx, {
          type: "bar",
          data: { labels: globalSubjects, datasets: datasets },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              x: {
                grid: { display: false },
                ticks: { font: { size: 13, weight: "bold" } },
              },
              y: {
                beginAtZero: true,
                position: "right",
                ticks: {
                  font: { size: 13 },
                  // Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ÙŠØ­ÙˆÙ„ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø­ÙˆØ± Ø§Ù„ØµØ§Ø¯ÙŠ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©
                  callback: function (value) {
                    return toArabicNumerals(value);
                  },
                },
              },
            },
            plugins: {
              legend: {
                position: "top",
                labels: { font: { size: 13, weight: "bold" } },
              },
              title: {
                display: true,
                text: "Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ Ù„Ù„Ù…ÙˆØ§Ø¯",
                font: { size: 16, family: "Cairo", weight: "bold" },
                padding: { bottom: 10 },
              },
              // Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ÙŠØ­ÙˆÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¹Ù†Ø¯ ØªÙ…Ø±ÙŠØ± Ø§Ù„Ù…Ø§ÙˆØ³ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©
              tooltip: {
                callbacks: {
                  label: function (context) {
                    return (
                      context.dataset.label +
                      ": " +
                      toArabicNumerals(context.raw)
                    );
                  },
                },
              },
            },
          },
        });
      }

      function exportToExcel() {
        if (globalSubjects.length === 0) {
          alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª!");
          return;
        }
        const data = [];
        globalSubjects.forEach((sub) => {
          const total = subjectTotals[sub] || 1;
          const row = { Ø§Ù„Ù…Ø§Ø¯Ø©: sub, "Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„ÙŠ": total };
          gradesOrder.forEach((g) => {
            row[`Ø¹Ø¯Ø¯ ${g}`] = globalCounts[sub][g];
          });
          gradesOrder.forEach((g) => {
            row[`Ù†Ø³Ø¨Ø© ${g}`] =
              ((globalCounts[sub][g] / total) * 100).toFixed(1) + "%";
          });
          const scores = subjectScores[sub] || [];
          row["Ø§Ù„Ù…ØªÙˆØ³Ø·"] = calcMean(scores);
          row["Ø§Ù„ÙˆØ³ÙŠØ·"] = calcMedian(scores);
          row["Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù"] = calcStdDev(scores);
          data.push(row);
        });
        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Ø§Ù„Ù†ØªØ§Ø¦Ø¬");
        XLSX.writeFile(wb, "Analysis_Report_V26.xlsx");
      }

      function calcMean(scores) {
        if (!scores || scores.length === 0) return "0";
        return (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(1);
      }
      function calcMedian(scores) {
        if (!scores || scores.length === 0) return "0";
        const s = [...scores].sort((a, b) => a - b);
        const m = Math.floor(s.length / 2);
        return s.length % 2 !== 0 ? s[m] : ((s[m - 1] + s[m]) / 2).toFixed(1);
      }
      function calcStdDev(scores) {
        if (!scores || scores.length === 0) return "0";
        const m = scores.reduce((a, b) => a + b, 0) / scores.length;
        return Math.sqrt(
          scores.map((v) => Math.pow(v - m, 2)).reduce((a, b) => a + b, 0) /
            scores.length,
        ).toFixed(2);
      }
      function toArabicNumerals(str) {
        return (str + "").replace(/[0-9]/g, (d) => "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©"[d]);
      }
    </script>
    <footer class="app-footer no-print" dir="rtl">
      <div>
        ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ø© ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø©:
        <a href="https://gemini.google.com/" target="_blank">Gemini 2.0</a>
        <span style="margin: 0 8px; color: #cbd5e1">|</span>
        <a href="https://t.me/Interact2030" target="_blank"
          >Ø­Ù‚ÙˆÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</a
        >
      </div>
    </footer>
  </body>
</html>
